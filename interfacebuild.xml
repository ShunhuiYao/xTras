<?xml version="1.0"?>
<project name="BuildUsageMessages" default="main" basedir=".">

	<!-- Change these two parameters as needed.	-->
	<property name="docInputDir" value="xTras/Documentation"/>
	<property name="outputFile"  value="xAct/xTras/Interface.m"/>
	
	<!-- No need to change anything below. -->
	<property name="inputDir" 	value="${basedir}/${docInputDir}/English/ReferencePages/Symbols" />
	<property name="output" 	value="${basedir}/${outputFile}" />
	<property name="jlinkpath" 	value="${mathematicaInstallDir}/SystemFiles/Links/JLink"/>
	<!-- Echo variables. -->
	<echo message="Mathematica Install Dir: ${mathematicaInstallDir}"/>
	<echo message="Input:  ${inputDir}"/>
	<echo message="Output: ${output}"/>
	<!-- Load JLink -->
	<path id="jlink.lib">
		<fileset dir="${jlinkpath}">
			<include name="**/JLink.jar"/>
			<include name="**/SystemFiles/*"/>
		</fileset>
	</path>
	<taskdef name="mathematica"	classname="com.wolfram.jlink.util.MathematicaTask" >
		<classpath refid="jlink.lib" />
	</taskdef>	
	<property name="JLinkLoaded" value="true"/>
	
	<!-- Build targets. -->
	<target name="main" depends="build" />
	<target name="build">
		<echo message="Mathematica" />
		<mathematica exe="${mathExe}">
			<![CDATA[
			(* full messages *)
			$MessagePrePrint = .
			
			(* Configure Front End *)
			If[AntProperty["frontEndLaunchFlags"] =!= Null,
				SetOptions[ Developer`InstallFrontEnd, Developer`LaunchFlags -> AntProperty["frontEndLaunchFlags"]]
			];
			
			$outputFile	= AntProperty["output"];
			$inputDir 	= AntProperty["inputDir"];
			baseDir		= AntProperty["basedir"];
			
			Get[FileNameJoin[{baseDir,"interfacebuild.m"}]];
			
			InterfaceBuild`ProcessDirectory[$inputDir, $outputFile, AntLog];
			
			]]>
		</mathematica>	      	
	</target>
	
</project>